# EVM Function Signature Finder

A CLI tool for analyzing Ethereum Virtual Machine (EVM) bytecode. This tool extracts function signatures from the bytecode and attempts to decode them using the [4bytes.directory](https://www.4byte.directory/) API.

**Note:** This project is **experimental** and primarily developed for personal use as part of my journey to learn Go. While it is open-source and functional, there might be areas that can be improved or refined. No guarantees or warranties are provided, use it at your own risk.

---

## Features

- Extract function selectors from EVM bytecode.
- Supports linear function dispatchers as well as those featuring a binary search.
- Decode function selectors into human-readable signatures using the 4bytes API.

---

## How does it work?
The tool identifies and processes the 11-byte dispatcher sequences generated by the Solidity compiler to extract function signatures. These sequences can follow two patterns:

| Linear | Binary Search |
|:------:|:-------------:|
|  DUP1  |      DUP1     |
|  PUSH4 |     PUSH4     |
|   EQ   |       GT      |
|  PUSH2 |     PUSH2     |
|  JUMPI |     JUMPI     |

### Workflow
- Linear Dispatchers: The tool collects all 4-byte function selectors directly from linear sequences in the bytecode.
- Binary Search Dispatchers: For bytecode featuring binary search patterns, the tool explores all jump destinations recursively to identify any linear sub-sequences containing function selectors.

By visiting and analyzing all reachable nodes in the bytecode, the tool ensures comprehensive extraction of function signatures.

---

## Limitations

- Because several functions can have the same function signature, the 4bytes API can return several matches for a single signature.
- This tool will work for contracts compiled using the solidity compiler, but won't for contracts compiled using different compilers as the bytecode produced might not have the same kind of function dispatcher.

---

## Usage

To run the CLI tool, use the following commands:

```bash
go run cmd/main.go [flags]

```

### Available Flags:

- `--rpc`: Specify the RPC endpoint for fetching on-chain bytecode.
- `--address`: Specify the smart contract address (used with `-rpc`).
- `--bytecode`: Provide the compiled contract bytecode directly

## Example Commands

### Analyze On-Chain Bytecode

```bash
go run cmd/main.go --rpc "https://mainnet.infura.io/v3/YOUR-PROJECT-ID" --address "0xContractAddress"
```

### Analyze Local Bytecode

```bash
go run cmd/main.go --bytecode "0x6003600501..."
```
